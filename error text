CREATE OR REPLACE EDITIONABLE TRIGGER "FUZE_COPY"."ONEF_TRG_PROJ_TRANSPORT_ATTRIBUTES_BEFORE_INSERT_OR_UPDATE"
BEFORE INSERT OR UPDATE ON PROJ_TRANSPORT_ATTRIBUTES FOR EACH ROW
declare isSuccess varchar2(32);
isSecondSuccess varchar2(32);
projType varchar2(32);
isProjWest NUMBER;
hubSiteInfoId NUMBER;
rowCount NUMBER;
siteInfoId NUMBER;
TechType varchar2(32);
projStatus varchar2(32);
hubProjectId NUMBER(16,0);
v_rowcount NUMBER DEFAULT 0;
v_hubReadyprojModType VARCHAR2(16);
v_projType varchar2(16);
v_rto_reset NUMBER DEFAULT 0;
porYear varchar2(32);
v_projModType varchar2(32);
v_oneFiberNPPFuze NUMBER DEFAULT 0;

BEGIN

-- NTSWSF-3276 Changes start here ----
	BEGIN
    select count(*) into  v_oneFiberNPPFuze from
    (select sp.TYPE  , pai.PROPOSED_SITE_TYPE
	from SITE_PROJECTS sp
	inner JOIN PROJ_ADDITIONAL_INFO pai ON sp.SITE_PROJECTS_ID = pai.SITE_PROJECTS_ID
	where
	pai.SITE_PROJECTS_ID= :NEW.SITE_PROJECTS_ID and sp.source = 'FUZE_PLANNING'
    and sp.TYPE =  'Initial Build' AND pai.PROPOSED_SITE_TYPE = 'MULTI-CUSTOMER-UNIT');
    EXCEPTION WHEN NO_DATA_FOUND THEN
    v_oneFiberNPPFuze := 0;
	END;
-- NTSWSF-3276 changes Ends here----

-- Get project TechType
    BEGIN
	SELECT CASE WHEN TECHNOLOGY_TYPE LIKE '%4G%' AND TECHNOLOGY_TYPE LIKE '%5G%' THEN 'BOTH' WHEN TECHNOLOGY_TYPE LIKE '%5G%' THEN '5G' ELSE '4G' END AS TECHNOLOGY_TYPE INTO TechType
	FROM PROJ_ADDITIONAL_INFO WHERE SITE_PROJECTS_ID=:NEW.SITE_PROJECTS_ID;
    EXCEPTION WHEN NO_DATA_FOUND THEN
	TechType := null;
    END;
---Get POR YEAR value
BEGIN
SELECT POR INTO porYear FROM SPM_PROJECT_TRACKER WHERE FUZE_PROJECT_ID=:NEW.SITE_PROJECTS_ID;
EXCEPTION WHEN NO_DATA_FOUND THEN
porYear := null;
END;


	BEGIN
	  SELECT SP.TYPE,CASE WHEN SP.TYPE='Modification' AND PAI.PROJ_MOD_TYPE IN ('TRANSPORT_ONLY','MICROWAVE_ONLY','HUB_HARDENING_NODE_CONVERSION','RF','DISMANTLEMENT') THEN 'true' ELSE 'false' END,PAI.PROJ_MOD_TYPE
      INTO v_projType,v_hubReadyprojModType,v_projModType
	  FROM SITE_PROJECTS SP
	  INNER JOIN PROJ_ADDITIONAL_INFO PAI ON SP.SITE_PROJECTS_ID = PAI.SITE_PROJECTS_ID
	  WHERE SP.SITE_PROJECTS_ID = :NEW.SITE_PROJECTS_ID;
	EXCEPTION WHEN NO_DATA_FOUND THEN
	  v_projType := null;
      v_hubReadyprojModType :='false';
	END;

IF INSERTING THEN
--	-- api queue entry - NEED_BY_DATE_CHANGE  -->(for recreate proj on FUZE-REJECT or EXCEPTION)
--	IF( :NEW.ONEF_SITE_NFID IS NOT NULL AND NVL(UPPER(:NEW.ONEF_NOTIFIED),' ') = 'YES' AND :NEW.TRANSPORT_VENDOR = 'OneFiber'  AND NVL(:NEW.TRANSPORT_NEED_BY_DATE,' ') != ' ') THEN
--		isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'NEED_BY_DATE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
--	END IF;

--- NTSWSF-3276 Changes start here ----
    IF ( v_onefibernppfuze > 0 ) THEN
	:new.transport_vendor := NULL;
	:new.final_hub_site_info_id := 0;
	:new.onef_fiber_strands_needed := NULL;
    END IF;
--- NTSWSF-3276 Changes ends here ----

    -- api queue entry - COE_CREATE
    IF ( NVL(:NEW.ONEF_SITE_NFID,' ') = ' ' AND NVL(UPPER(:NEW.ONEF_NOTIFIED),' ') != 'YES' AND NVL(:NEW.TRANSPORT_VENDOR,' ') = 'OneFiber' ) THEN
		IF( NVL(:NEW.FINAL_HUB_SITE_INFO_ID,0) != 0 AND NVL(:NEW.UACE_ID,0) != 0 AND NVL(:NEW.ONEF_FIBER_STRANDS_NEEDED,' ') NOT IN (' ')) THEN
			:NEW.ONEF_NOTIFIED :='YES';
			isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'COE_CREATE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
		ELSE
			:NEW.CRAN_PEER_SITE_STATUS :='UserError';
			:NEW.ONEF_STATUS_DESCRIPTION :='One or more of the required fields for your site to push to CoFFEE (VZB) is not populated';
		END IF;
    END IF;
    -- Not allow FOC fields to be edited when TRANSPORT_VENDOR in ('OneFiber','Hub-OneFiber')
    IF( :NEW.TRANSPORT_VENDOR in ('OneFiber','Hub-OneFiber')) THEN
	:NEW.TRANS_CONTR_FOC_FC_DT := null;
	:NEW.TRANS_CONTR_FOC_AC_DT := null;
    END IF;
    -- Not allow CIRCUIT_DELIVERY(TRANSPORT COMPLETE) fields to be edited when TRANSPORT_VENDOR='OneFiber' and WEST projs
    -- IF(  :NEW.TRANSPORT_VENDOR = 'OneFiber' AND isProjWest > 0) THEN
    --	   :NEW.CIRCUIT_DELIVERY_EST := null;
    --	   :NEW.CIRCUIT_DELIVERY_ACT := null;
    -- END IF;
   -- non editable fields start --
    -- IF( (:NEW.TRANSPORT_VENDOR NOT IN ('OneFiber','Hub-OneFiber','VZT FUZE') and :OLD.TRANSPORT_VENDOR != 'OneFiber') and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC')) THEN
	IF(TRIM(:NEW.TRANSPORT_VENDOR) IS NULL and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC')) THEN
	:NEW.ONEF_FIBER_STRANDS_NEEDED := null;
    END IF;
    IF( (:NEW.TRANSPORT_VENDOR = 'OneFiber' and :OLD.TRANSPORT_VENDOR != 'OneFiber') and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC')) THEN
	:NEW.SPLICE_AND_TEST_EST := null;
	:NEW.SPLICE_AND_TEST_ACT := null;
	:NEW.CABLE_PLACED_EST := null;
	:NEW.CABLE_PLACED_ACT := null;
	:NEW.PERMITS_RECEIVED_EST := null;
	:NEW.PERMITS_RECEIVED_ACT := null;
    END IF;
    -- IF( (:NEW.TRANSPORT_VENDOR != 'OneFiber' and :OLD.TRANSPORT_VENDOR != 'OneFiber') and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC')) THEN
	-- :NEW.POR_SITE := null;
    -- END IF;
-- Start Comment by KG
    -- IF( (:NEW.TRANSPORT_VENDOR != 'Hub-OneFiber' OR :NEW.TRANSPORT_VENDOR IS NULL) and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC')) THEN
    --	   :NEW.ONEF_HUB_SIZE := null;
    -- :NEW.ONEF_CLLI := null;
    -- :NEW.MSC := null;
    -- :NEW.ONEF_HUB_TYPE  := null;
    -- :NEW.ONEF_BUILDING_OWNER  := null;
    -- :NEW.ONEF_ASSESSMENT_VZB_DATE := null;
    -- :NEW.ONEF_REVIEW_DATE := null;
    -- :NEW.ONEF_ENTITLEMENTS_COMPLETE := null;
    -- :NEW.ONEF_ENTITLEMENT_DATE := null;
    -- :NEW.ONEF_LOCATION_LEASE_OR_OWNED := null;
    -- :NEW.BACKHAUL_NEED_BY_DATE := null;
    -- :NEW.ONEF_LOCATION_TYPE := null;
    -- :NEW.ONEF_SPACE_POWER_ASSESSMENT_INCLUDE_VZB_NEEDS := null;
    -- :NEW.ONEF_ASSESSMENT_DATE := null;
    -- END IF;
-- End Comment by KG
	-- non editable fields end --
-- FINAL_HUB_SITE_INFO_ID Updates start
    IF(:NEW.FINAL_HUB_SITE_INFO_ID != 0) THEN
    -- Updating the FINAL_HUB_SITE_INFO_ID at sites
--	  PROC_SYNC_FINAL_HUB_PROJ_TO_SITE(:NEW.SITE_PROJECTS_ID,:NEW.FINAL_HUB_SITE_INFO_ID,:NEW.TRANSPORT_VENDOR,:NEW.LAST_MODIFIED_BY);
	INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_SYNC_FINAL_HUB_PROJ_TO_SITE('||:NEW.SITE_PROJECTS_ID||','||:NEW.FINAL_HUB_SITE_INFO_ID||','''||:NEW.TRANSPORT_VENDOR||''','''||:NEW.LAST_MODIFIED_BY||''')',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    -- Updating the FINAL_HUB_SITE_INFO_ID in GRANITE
	PROC_INSERT_API_QUEUE('GRANITE','UPDATE_SITE',NULL,:NEW.SITE_PROJECTS_ID,NULL,NULL,NULL,'QUEUED',:NEW.LAST_MODIFIED_BY);
    END IF;
-- FINAL_HUB_SITE_INFO_ID Updates end
    -- Updating the Hub Size at sites
    IF (NVL(:NEW.ONEF_HUB_SIZE,' ')!= ' ') THEN
	INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	declare
	v_rowcount NUMBER DEFAULT 0;
	Begin
	FOR ax in (SELECT SI.SITE_INFO_ID,CI.HUB_SITE_INFO_ID FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
	INNER JOIN CRAN_INFO CI ON CI.HUB_SITE_INFO_ID=SI.SITE_INFO_ID AND CI.CRAN_STATUS!=''DELETED'' WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	UPDATE CRAN_INFO SET
	APPROVED_HUB_DESIGNATION='''||:NEW.ONEF_HUB_SIZE||''',
	CRAN_LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
	CRAN_LAST_MODIFIED_DATE = SYSDATE
	WHERE HUB_SITE_INFO_ID=ax.HUB_SITE_INFO_ID;
	v_rowcount := SQL%rowcount;
	END LOOP;
	END;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    -- Updating the Hub Size at sites
	IF(TRIM(:NEW.TRANSPORT_VENDOR) IS NOT NULL AND TRIM(:OLD.TRANSPORT_VENDOR) IS NULL) THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''ENABLE_TRANSPORT_NON_ONEF'',''COMPLETE'',''ACTIVE'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,NULL)',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
	END IF;
	IF(NVL(TRIM(:NEW.TRANSPORT_VENDOR),' ') != NVL(TRIM(:OLD.TRANSPORT_VENDOR),' ')) THEN
		IF(:NEW.TRANSPORT_VENDOR ='MICROWAVE' AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'MICROWAVE') IN('INACTIVE','N/A'))THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''MICROWAVE_INSERT'',''COMPLETE'',''ACTIVE'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
		END IF;
		IF(:OLD.TRANSPORT_VENDOR ='MICROWAVE' AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'MICROWAVE') NOT IN('N/A'))THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''MICROWAVE_INSERT'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
		END IF;
		IF(:NEW.TRANSPORT_VENDOR IN('OneFiber','Hub-OneFiber','VZT FUZE','VZT HUB','VZT FUZE Disconnect') AND nvl(:OLD.TRANSPORT_VENDOR,' ') NOT IN('OneFiber','Hub-OneFiber','VZT FUZE','VZT HUB','VZT FUZE Disconnect') AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'ONE_FIBER') IN('INACTIVE','N/A'))THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''ONE_FIBER_INACTIVE'',''COMPLETE'',''ACTIVE'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
		END IF;
		IF(:OLD.TRANSPORT_VENDOR IN('OneFiber','Hub-OneFiber','VZT FUZE','VZT HUB','VZT FUZE Disconnect') AND :NEW.TRANSPORT_VENDOR NOT IN('OneFiber','Hub-OneFiber','VZT FUZE','VZT HUB','VZT FUZE Disconnect') AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'ONE_FIBER') NOT IN('N/A'))THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''ONE_FIBER_INACTIVE'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
		END IF;
	END IF;
	IF(TRIM(:NEW.TRANSPORT_VENDOR) IS NULL AND TRIM(:OLD.TRANSPORT_VENDOR) IS NOT NULL AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'TRANSPORT') ='ACTIVE') THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''ENABLE_TRANSPORT_NON_ONEF'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,NULL)',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
	END IF;
--removing the clusterNfid if OneFiber is moved to Hub-OneFiber
     IF(:NEW.TRANSPORT_VENDOR = 'Hub-OneFiber' AND :OLD.TRANSPORT_VENDOR = 'OneFiber') THEN
     :NEW.ONEF_CLUSTER_NFID :=NULL;
     END IF;
    -- create hub in cran when Hub-OneFiber vendor is selected
    IF(:NEW.TRANSPORT_VENDOR = 'Hub-OneFiber') THEN
	BEGIN
	    SELECT SI.SITE_INFO_ID into hubSiteInfoId FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in ('Primary','Live')
	    WHERE SITE_PROJECTS_ID=:NEW.SITE_PROJECTS_ID;
	EXCEPTION WHEN NO_DATA_FOUND THEN
	    hubSiteInfoId := 0;
	END;
	INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	declare
	v_rowcount NUMBER DEFAULT 0;
	Begin
	for ax in
	( SELECT SI.* FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'') WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	      loop
	       UPDATE CRAN_INFO
	       SET CRAN_STATUS= '' '',
	       CRAN_LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
	       CRAN_LAST_MODIFIED_DATE = SYSDATE
	       where HUB_SITE_INFO_ID = ax.SITE_INFO_ID;
	       v_rowcount := SQL%rowcount;
	       IF(v_rowcount = 0) THEN
		  insert into CRAN_INFO
		    (HUB_SITE_INFO_ID,CRAN_NAME,CRAN_STATUS,FINAL_HUB_SITE_NAME,FINAL_HUB_SITE_ID,CRAN_LAST_MODIFIED_BY,CRAN_LAST_MODIFIED_DATE)
		VALUES
		    (ax.SITE_INFO_ID,ax.SITE_NAME,'' '',ax.SITE_NAME,ax.SITE_INFO_ID,'''||:NEW.LAST_MODIFIED_BY||''',SYSDATE);
		end if;
	    END LOOP;
	    end;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    -- create hub in cran when Hub-OneFiber vendor is selected
    IF(NVL(:NEW.ONEF_PSCR_READY_F,' ')!= ' ') THEN
	INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	declare
	v_rowcount NUMBER DEFAULT 0;
	Begin
	FOR ax in (SELECT SI.SITE_INFO_ID FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
	WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	LOOP
	UPDATE CRAN_TRACKER_INFO SET
	ONEF_PSCR_READY_F='''||:NEW.ONEF_PSCR_READY_F||''',
	LAST_MODIFIED_BY ='''||:NEW.LAST_MODIFIED_BY||''',
	LAST_MODIFIED_DATE = SYSDATE
	WHERE SITE_INFO_ID=ax.SITE_INFO_ID;
	v_rowcount := SQL%rowcount;
	END LOOP;
	end;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    IF(NVL(:NEW.ONEF_PSCR_READY_A,' ')!= ' ') THEN
	    INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	    VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	    declare
	    v_rowcount NUMBER DEFAULT 0;
	    Begin
	    for ax in
	    (SELECT SI.SITE_INFO_ID FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
	    WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	    LOOP
		UPDATE CRAN_TRACKER_INFO SET
		ONEF_PSCR_READY_A='''||:NEW.ONEF_PSCR_READY_A||''',
		LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
		LAST_MODIFIED_DATE = SYSDATE
		where SITE_INFO_ID = ax.SITE_INFO_ID;
		v_rowcount := SQL%rowcount;
	    end loop;
	    end;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    IF(NVL(:NEW.ONEF_HUB_DUAL_ENTRY_F,' ')!= ' ') THEN
	   INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	   VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	   declare
	   v_rowcount NUMBER DEFAULT 0;
	   Begin
	   FOR ax in (SELECT SI.SITE_INFO_ID FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
			WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	    LOOP
	       UPDATE CRAN_TRACKER_INFO SET
	       HUB_DUAL_ENTRY_F='''||:NEW.ONEF_HUB_DUAL_ENTRY_F||''',
	       LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
	       LAST_MODIFIED_DATE = SYSDATE
	       where SITE_INFO_ID = ax.SITE_INFO_ID;
	       v_rowcount := SQL%rowcount;
	     end loop;
	     end;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    IF(NVL(:NEW.ONEF_HUB_DUAL_ENTRY_A,' ')!= ' ') THEN
	   INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	   VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	   declare
	   v_rowcount NUMBER DEFAULT 0;
	   Begin
	   FOR ax in (SELECT SI.SITE_INFO_ID FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
			WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	    LOOP
	       UPDATE CRAN_TRACKER_INFO SET
	       HUB_DUAL_ENTRY_A='''||:NEW.ONEF_HUB_DUAL_ENTRY_A||''',
	       LAST_MODIFIED_BY ='''|| :NEW.LAST_MODIFIED_BY||''',
	       LAST_MODIFIED_DATE = SYSDATE
	       where SITE_INFO_ID = ax.SITE_INFO_ID;
	       v_rowcount := SQL%rowcount;
	     end loop;
	     end;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    -- Api queue insert to create new quote
    IF (:NEW.IS_BULK_QUOTE_CREATE='YES' AND :NEW.TRANSPORT_VENDOR = 'VZT FUZE' AND NVL(:NEW.FINAL_HUB_SITE_INFO_ID,0)!=0 AND NVL(:NEW.TRANSPORT_NEED_BY_DATE,' ')!=' ' AND NVL(:NEW.ONEF_FIBER_STRANDS_NEEDED,' ')!=' '
	AND NVL(:NEW.PRODUCT_TYPE,' ')!=' ' AND NVL(:NEW.PRODUCT_SUB_TYPE,' ')!=' ' AND NVL(:NEW.SERVICE_DESCRIPTOR,' ')!=' ' AND NVL(:NEW.DISTANCE_LIMITATION,0)!=0
	AND NVL(:NEW.CONNECTOR_TYPE,' ')!=' ' AND NVL(:NEW.STRUCTURE_TYPE,' ')!=' ' ) THEN
	    isSuccess := FUNC_INSERT_API_QUEUE('INFRANCHISE','CREATE_QUOTE',NULL,:NEW.SITE_PROJECTS_ID,NULL,NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
	    :NEW.IS_BULK_QUOTE_CREATE :=NULL;
    END IF;
	   --TRANSPORT_TYPE_APPLIED field condition
	   IF (NVL(TRIM(:NEW.TRANSPORT_TYPE),' ') != NVL(TRIM(:old.TRANSPORT_TYPE),' ')) THEN
			IF (NVL(TRIM(:NEW.TRANSPORT_TYPE),' ') != ' ') THEN
				:new.TRANSPORT_TYPE_APPLIED:=TO_CHAR(SYSDATE, 'mm/dd/yyyy');
			ELSE
				:new.TRANSPORT_TYPE_APPLIED:=NULL;
			END IF;
	   END IF;
	 --Make Transport milestone NA if transport vendor removed
	IF(TRIM(:NEW.TRANSPORT_VENDOR) IS NULL AND TRIM(:OLD.TRANSPORT_VENDOR) IS NOT NULL AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'TRANSPORT') ='COMPLETED' and v_projType = 'Modification' and v_projModType NOT IN('TRANSPORT_DISCONNECT','TRANSPORT_ETL_DISCONNECT')) THEN
		INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY) VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''ENABLE_TRANSPORT_NON_ONEF'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,NULL)',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
	END IF;
	--Make Hub-ready milestone NA if FINAL_HUB_SITE_INFO_ID removed
	IF (NVL(:OLD.FINAL_HUB_SITE_INFO_ID,0) != 0 AND NVL(:NEW.FINAL_HUB_SITE_INFO_ID,0) = 0	AND v_projType = 'Modification' AND v_projModType NOT IN('TRANSPORT_DISCONNECT','TRANSPORT_ETL_DISCONNECT')) THEN
		INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''HUB_READY_INSERT'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
		CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
	END IF;
END IF;
IF UPDATING THEN
-- api queue entry code starts
IF(:NEW.ONEF_SITE_NFID IS NOT NULL AND :OLD.TRANSPORT_VENDOR = 'VZT FUZE' AND NVL(:OLD.TRANSPORT_VENDOR,' ') != NVL(:NEW.TRANSPORT_VENDOR,' ')) THEN
	:NEW.ONEF_SITE_NFID :=NULL;
END IF;
    -- api queue entry - COE_CREATE
    -- VZT Precandidate: COE_CREATE will be triggered when initial quote is saved. Hence no code for that in this trigger.
    IF ( NVL(:NEW.ONEF_SITE_NFID,' ') = ' ' AND :NEW.TRANSPORT_VENDOR = 'OneFiber'  AND NVL(UPPER(:NEW.ONEF_NOTIFIED),' ') != 'YES') THEN
	IF (:NEW.FINAL_HUB_SITE_INFO_ID IS NOT NULL AND :NEW.UACE_ID IS NOT NULL AND :NEW.TRANSPORT_VENDOR IS NOT NULL AND :NEW.ONEF_FIBER_STRANDS_NEEDED IS NOT NULL AND
	    :NEW.FINAL_HUB_SITE_INFO_ID !=0 AND :NEW.UACE_ID !=0 AND :NEW.TRANSPORT_VENDOR !=' ' AND :NEW.ONEF_FIBER_STRANDS_NEEDED NOT IN (' ')) THEN
	    :NEW.ONEF_NOTIFIED :='YES';
	    isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'COE_CREATE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
	ELSE
	    :NEW.CRAN_PEER_SITE_STATUS :='UserError';
	    :NEW.ONEF_STATUS_DESCRIPTION :='One or more of the required fields for your site to push to CoFFEE (VZB) is not populated';
	END IF;
    END IF;
	-- Remove ONEF_NOTIFIED if Transport Vendor Changed From VZT FUZE
	IF(:OLD.TRANSPORT_VENDOR = 'VZT FUZE' and :NEW.TRANSPORT_VENDOR != 'VZT FUZE') THEN
	:NEW.ONEF_NOTIFIED :='NO';
	END IF;
	IF(TRIM(:NEW.TRANSPORT_VENDOR) IS NOT NULL AND TRIM(:OLD.TRANSPORT_VENDOR) IS NULL) THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''ENABLE_TRANSPORT_NON_ONEF'',''COMPLETE'',''ACTIVE'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,NULL)',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
	END IF;
	IF(NVL(TRIM(:NEW.TRANSPORT_VENDOR),' ') != NVL(TRIM(:OLD.TRANSPORT_VENDOR),' ')) THEN
		IF(:NEW.TRANSPORT_VENDOR ='MICROWAVE' AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'MICROWAVE') IN('INACTIVE','N/A'))THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''MICROWAVE_INSERT'',''COMPLETE'',''ACTIVE'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
		END IF;
		IF(:OLD.TRANSPORT_VENDOR ='MICROWAVE' AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'MICROWAVE') NOT IN('N/A'))THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''MICROWAVE_INSERT'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
		END IF;
		IF(:NEW.TRANSPORT_VENDOR IN('OneFiber','Hub-OneFiber','VZT FUZE','VZT HUB','VZT FUZE Disconnect') AND nvl(:OLD.TRANSPORT_VENDOR,' ') NOT IN('OneFiber','Hub-OneFiber','VZT FUZE','VZT HUB','VZT FUZE Disconnect') AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'ONE_FIBER') IN('INACTIVE','N/A'))THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''ONE_FIBER_INACTIVE'',''COMPLETE'',''ACTIVE'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
		END IF;
		IF(:OLD.TRANSPORT_VENDOR IN('OneFiber','Hub-OneFiber','VZT FUZE','VZT HUB','VZT FUZE Disconnect') AND :NEW.TRANSPORT_VENDOR NOT IN('OneFiber','Hub-OneFiber','VZT FUZE','VZT HUB','VZT FUZE Disconnect') AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'ONE_FIBER') NOT IN('N/A'))THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''ONE_FIBER_INACTIVE'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
		END IF;
	END IF;
	IF(TRIM(:NEW.TRANSPORT_VENDOR) IS NULL AND TRIM(:OLD.TRANSPORT_VENDOR) IS NOT NULL AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'TRANSPORT') ='ACTIVE') THEN
			 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''ENABLE_TRANSPORT_NON_ONEF'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,NULL)',
			CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
	END IF;
    -- api queue entry - HUB_MOVE
    IF (:NEW.ONEF_SITE_NFID IS NOT NULL AND :NEW.TRANSPORT_VENDOR = 'OneFiber'	AND :OLD.FINAL_HUB_SITE_INFO_ID !=0 AND :OLD.FINAL_HUB_SITE_INFO_ID != :NEW.FINAL_HUB_SITE_INFO_ID) THEN
	isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'HUB_MOVE',:OLD.ONEF_CLUSTER_NFID,0,NULL,:NEW.LAST_MODIFIED_BY);
	:NEW.ONEF_CLUSTER_NFID :=NULL;
    END IF;
    -- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - HUB_MOVE
    IF(:NEW.ONEF_SITE_NFID IS NULL AND :NEW.TRANSPORT_VENDOR = 'OneFiber'  AND :OLD.FINAL_HUB_SITE_INFO_ID !=0 AND :OLD.FINAL_HUB_SITE_INFO_ID != :NEW.FINAL_HUB_SITE_INFO_ID ) THEN
	INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
	VALUES(null,:NEW.SITE_PROJECTS_ID,'HUB_MOVE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
    END IF;
-- VZT Precandidate
-- api queue entry - HUB_MOVE - INFRANCHISE precandidate
	IF (:NEW.ONEF_SITE_NFID IS NOT NULL AND :NEW.TRANSPORT_VENDOR = 'VZT FUZE'	AND :OLD.FINAL_HUB_SITE_INFO_ID !=0 AND :OLD.FINAL_HUB_SITE_INFO_ID != :NEW.FINAL_HUB_SITE_INFO_ID) THEN
	isSuccess := FUNC_INSERT_API_QUEUE('INFRANCHISE','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'HUB_MOVE',:OLD.ONEF_CLUSTER_NFID,0,NULL,:NEW.LAST_MODIFIED_BY);
	:NEW.ONEF_CLUSTER_NFID :=NULL;
    END IF;
    -- VZT Precandidate
    -- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - HUB_MOVE
    IF(:NEW.ONEF_SITE_NFID IS NULL AND :NEW.TRANSPORT_VENDOR = 'VZT FUZE'  AND :OLD.FINAL_HUB_SITE_INFO_ID !=0 AND :OLD.FINAL_HUB_SITE_INFO_ID != :NEW.FINAL_HUB_SITE_INFO_ID ) THEN
	INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
	VALUES(null,:NEW.SITE_PROJECTS_ID,'HUB_MOVE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
    END IF;
		-- NTSCC-6932, NTSCC-8902
	IF(:NEW.ONEF_SITE_NFID IS NOT NULL AND :OLD.TRANSPORT_VENDOR = 'OneFiber'  AND NVL(:OLD.TRANSPORT_VENDOR,' ') != NVL(:NEW.TRANSPORT_VENDOR,' ')) THEN
		BEGIN
			SELECT STATUS INTO projStatus FROM SITE_PROJECTS WHERE SITE_PROJECTS_ID=:NEW.SITE_PROJECTS_ID;
		EXCEPTION WHEN NO_DATA_FOUND THEN
			projStatus := null;
		END;
		IF(UPPER(projStatus) != 'FUZE_REJECT') THEN
			isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'TRANSPORT_VENDOR_MOVE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
		END IF;
		--:NEW.ONEF_SITE_NFID :=NULL;
		--:NEW.ONEF_CLUSTER_NFID :=NULL;
		--:NEW.CABLE_PLACED_ACT :=NULL;
		--:NEW.CABLE_PLACED_EST :=NULL;
		--:NEW.SPLICE_AND_TEST_EST :=NULL;
		--:NEW.SPLICE_AND_TEST_ACT :=NULL;
		--:NEW.TRANS_CONTR_FOC_AC_DT :=NULL;
		--:NEW.PERMITS_RECEIVED_EST :=NULL;
		--:NEW.PERMITS_RECEIVED_ACT :=NULL;
		--:NEW.VZB_CONSTRUCTION_START_EST :=NULL;
		--:NEW.VZB_CONSTRUCTION_START_ACT :=NULL;
		--:NEW.VZB_PERMITS_SUBMITTED_EST :=NULL;
		--:NEW.VZB_PERMITS_SUBMITTED_ACT :=NULL;
		--:NEW.VZB_NTP_SUBMITTED_TO_VENDOR_EST :=NULL;
		--:NEW.VZB_NTP_SUBMITTED_TO_VENDOR_ACT :=NULL;
		--:NEW.SITE_SURVEY_EST :=NULL;
		--:NEW.SITE_SURVEY_ACT :=NULL;
    END IF;
    -- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - when TRANSPORT_VENDOR changed from OneFiber- TRANSPORT_VENDOR_MOVE - CANCEL flow
    IF(:NEW.ONEF_SITE_NFID IS NULL AND :OLD.TRANSPORT_VENDOR = 'OneFiber'  AND :OLD.TRANSPORT_VENDOR != NVL(:NEW.TRANSPORT_VENDOR,' ')) THEN
	BEGIN
	    SELECT STATUS INTO projStatus FROM SITE_PROJECTS WHERE SITE_PROJECTS_ID=:NEW.SITE_PROJECTS_ID;
	EXCEPTION WHEN NO_DATA_FOUND THEN
	    projStatus := null;
	END;
	IF(UPPER(projStatus) != 'FUZE_REJECT') THEN
	    INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
	    VALUES(null,:NEW.SITE_PROJECTS_ID,'TRANSPORT_VENDOR_MOVE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
	END IF;
    END IF;
    -- api queue entry when TRANSPORT_VENDOR back to OneFiber -UNCANCEL_TRANSPORT_VENDOR_MOVE - UNCANCEL flow
    IF( :NEW.ONEF_SITE_NFID IS NOT NULL AND NVL(:OLD.TRANSPORT_VENDOR,' ') != NVL(:NEW.TRANSPORT_VENDOR,' ') AND :NEW.TRANSPORT_VENDOR = 'OneFiber') THEN
	    :NEW.ONEF_NOTIFIED :='YES';
	isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'UNCANCEL_TRANSPORT_VENDOR_MOVE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
    END IF;
    -- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - when TRANSPORT_VENDOR back to OneFiber -UNCANCEL_TRANSPORT_VENDOR_MOVE - UNCANCEL flow
    IF(:NEW.ONEF_SITE_NFID IS NULL AND NVL(:OLD.TRANSPORT_VENDOR,' ') !=' ' AND :OLD.TRANSPORT_VENDOR != NVL(:NEW.TRANSPORT_VENDOR,' ') AND :NEW.TRANSPORT_VENDOR = 'OneFiber') THEN
	INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
	VALUES(null,:NEW.SITE_PROJECTS_ID,'UNCANCEL_TRANSPORT_VENDOR_MOVE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
    END IF;
--	-- api queue entry - NEED_BY_DATE_CHANGE
--	IF(:NEW.TRANSPORT_VENDOR = 'OneFiber' AND :NEW.ONEF_SITE_NFID IS NOT NULL AND NVL(:OLD.TRANSPORT_NEED_BY_DATE,' ') != NVL(:NEW.TRANSPORT_NEED_BY_DATE,' ')) THEN
--		isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'NEED_BY_DATE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
--    -- nfid swap
--    ELSIF(:OLD.TRANSPORT_VENDOR != 'OneFiber' AND :NEW.TRANSPORT_VENDOR = 'OneFiber' AND :OLD.ONEF_SITE_NFID IS NULL AND :NEW.ONEF_SITE_NFID IS NOT NULL AND UPPER(:OLD.ONEF_NOTIFIED)!='YES' AND UPPER(:NEW.ONEF_NOTIFIED) = 'YES') THEN
--		isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'NEED_BY_DATE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
--	END IF;
--	-- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - NEED_BY_DATE_CHANGE
--	IF(:NEW.TRANSPORT_VENDOR = 'OneFiber'  AND :NEW.ONEF_SITE_NFID IS NULL AND NVL(:OLD.TRANSPORT_NEED_BY_DATE,' ') != NVL(:NEW.TRANSPORT_NEED_BY_DATE,' ')) THEN
--		INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
--		VALUES(null,:NEW.SITE_PROJECTS_ID,'NEED_BY_DATE_CHANGE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
--	END IF;
--- VZT Precandidate | MILESTONE_CHANGE applies to Infranchise but not OneFiber
	-- api queue entry - MILESTONE_CHANGE - INFRANCHISE precandidate
	IF(:NEW.TRANSPORT_VENDOR = 'VZT FUZE' AND :NEW.ONEF_SITE_NFID IS NOT NULL AND NVL(:OLD.TRANSPORT_NEED_BY_DATE,' ') != NVL(:NEW.TRANSPORT_NEED_BY_DATE,' ')) THEN
		isSuccess := FUNC_INSERT_API_QUEUE('INFRANCHISE','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
    -- nfid swap
    ELSIF(:OLD.TRANSPORT_VENDOR != 'VZT FUZE' AND :NEW.TRANSPORT_VENDOR = 'OneFiber' AND :OLD.ONEF_SITE_NFID IS NULL AND :NEW.ONEF_SITE_NFID IS NOT NULL AND UPPER(:OLD.ONEF_NOTIFIED)!='YES' AND UPPER(:NEW.ONEF_NOTIFIED) = 'YES') THEN
		isSuccess := FUNC_INSERT_API_QUEUE('INFRANCHISE','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
	END IF;

	-- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - NEED_BY_DATE_CHANGE
--	IF(:NEW.TRANSPORT_VENDOR = 'VZT FUZE'  AND :NEW.ONEF_SITE_NFID IS NULL AND NVL(:OLD.TRANSPORT_NEED_BY_DATE,' ') != NVL(:NEW.TRANSPORT_NEED_BY_DATE,' ')) THEN
--		INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
--		VALUES(null,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
--	END IF;

	-- api queue entry - MILESTONE_CHANGE
    IF(:NEW.ONEF_SITE_NFID IS NOT NULL AND :NEW.TRANSPORT_VENDOR = 'OneFiber'  AND NVL(:OLD.ONEF_TRANSPORT_ROOM_READY_F,' ') != NVL(:NEW.ONEF_TRANSPORT_ROOM_READY_F,' ')) THEN
	isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
    END IF;
    -- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - MILESTONE_CHANGE
--    IF(:NEW.ONEF_SITE_NFID IS NULL AND :NEW.TRANSPORT_VENDOR = 'OneFiber'  AND NVL(:OLD.ONEF_TRANSPORT_ROOM_READY_F,' ') != NVL(:NEW.ONEF_TRANSPORT_ROOM_READY_F,' ')) THEN
--	INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
--	VALUES(null,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
--    END IF;
    -- api queue entry - MILESTONE_CHANGE
    IF(:NEW.ONEF_SITE_NFID IS NOT NULL AND :NEW.TRANSPORT_VENDOR = 'OneFiber'  AND NVL(:OLD.ONEF_TRANSPORT_ROOM_READY_A,' ') != NVL(:NEW.ONEF_TRANSPORT_ROOM_READY_A,' ')) THEN
	isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
    END IF;
    -- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - MILESTONE_CHANGE
--    IF(:NEW.ONEF_SITE_NFID IS NULL AND :NEW.TRANSPORT_VENDOR = 'OneFiber'  AND NVL(:OLD.ONEF_TRANSPORT_ROOM_READY_A,' ') != NVL(:NEW.ONEF_TRANSPORT_ROOM_READY_A,' ')) THEN
--	INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
--	VALUES(null,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
--    END IF;
    --- VZT Precandidate
    -- api queue entry - MILESTONE_CHANGE - INFRANCHISE precandidate -- START
    IF(:NEW.ONEF_SITE_NFID IS NOT NULL AND :NEW.TRANSPORT_VENDOR = 'VZT FUZE'  AND NVL(:OLD.ONEF_TRANSPORT_ROOM_READY_F,' ') != NVL(:NEW.ONEF_TRANSPORT_ROOM_READY_F,' ')) THEN
	isSuccess := FUNC_INSERT_API_QUEUE('INFRANCHISE','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
    END IF;
    -- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - MILESTONE_CHANGE
--    IF(:NEW.ONEF_SITE_NFID IS NULL AND :NEW.TRANSPORT_VENDOR = 'VZT FUZE'  AND NVL(:OLD.ONEF_TRANSPORT_ROOM_READY_F,' ') != NVL(:NEW.ONEF_TRANSPORT_ROOM_READY_F,' ')) THEN
--	INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
--	VALUES(null,:NEW.SITE_PROJECTS_ID,'VZW_TELCO_READY_CHANGE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
--    END IF;

    -- api queue entry - MILESTONE_CHANGE
    IF(:NEW.ONEF_SITE_NFID IS NOT NULL AND :NEW.TRANSPORT_VENDOR = 'VZT FUZE'  AND NVL(:OLD.ONEF_TRANSPORT_ROOM_READY_A,' ') != NVL(:NEW.ONEF_TRANSPORT_ROOM_READY_A,' ')) THEN
	isSuccess := FUNC_INSERT_API_QUEUE('INFRANCHISE','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
    END IF;
    -- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - MILESTONE_CHANGE
--    IF(:NEW.ONEF_SITE_NFID IS NULL AND :NEW.TRANSPORT_VENDOR = 'VZT FUZE'  AND NVL(:OLD.ONEF_TRANSPORT_ROOM_READY_A,' ') != NVL(:NEW.ONEF_TRANSPORT_ROOM_READY_A,' ')) THEN
--	INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
--	VALUES(null,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
--    END IF;


    -- api queue entry - SITE_EXCEPTION_STATUS = 'Approved'
    IF(NVL(:OLD.SITE_EXCEPTION_STATUS,' ') != NVL(:NEW.SITE_EXCEPTION_STATUS,' ') AND :NEW.SITE_EXCEPTION_ID IS NOT NULL AND UPPER(:NEW.SITE_EXCEPTION_STATUS) = 'APPROVED') THEN
	isSuccess := FUNC_INSERT_API_QUEUE('SPM','MOD_ON_EXCEPTION',NULL,:NEW.SITE_PROJECTS_ID,NULL,:NEW.SITE_EXCEPTION_STATUS,0,NULL,:NEW.LAST_MODIFIED_BY);
    END IF;

	--RTO fiber validation
    IF ((NVL(:OLD.RTO_ACT, ' ') != NVL(:NEW.RTO_ACT, ' ')) OR (NVL(TRIM(:NEW.TRANSPORT_VENDOR),' ') != NVL(TRIM(:OLD.TRANSPORT_VENDOR),' ') AND (NVL(TRIM(:NEW.TRANSPORT_VENDOR),' ') IS NULL OR NVL(:NEW.TRANSPORT_VENDOR,' ') = ' ')))  THEN
	v_rto_reset := FUNC_RTO_FIBER_VALIDATION(:NEW.SITE_PROJECTS_ID,:NEW.RTO_ACT,:NEW.TRANSPORT_VENDOR);
	IF v_rto_reset = 1 THEN
	    :NEW.RTO_ACT := NULL;
	END IF;
    END IF;
	---POR SITE CONDTION CHECK
	IF(porYear IS NULL) THEN
	:NEW.POR_SITE :='No';
	END IF;
    -- api queue entry - MILESTONE_CHANGE
    IF (NVL(UPPER(:NEW.ONEF_NOTIFIED),' ') = 'YES' AND :NEW.TRANSPORT_VENDOR = 'OneFiber') THEN
	IF(:NEW.ONEF_SITE_NFID IS NOT NULL AND ( NVL(:OLD.POR_SITE,' ') != NVL(:NEW.POR_SITE,' ') OR NVL(:OLD.ONEF_FIBER_STRANDS_NEEDED,' ') != NVL(:NEW.ONEF_FIBER_STRANDS_NEEDED,' ') OR
	    NVL(:OLD.HUB_DETAILS,' ') != NVL(:NEW.HUB_DETAILS,' ') OR NVL(:OLD.BUILD_PLAN_YEAR_STATUS,' ') != NVL(:NEW.BUILD_PLAN_YEAR_STATUS,' ') OR NVL(:OLD.ROOT_RANK,' ') != NVL(:NEW.ROOT_RANK,' ') OR
	    NVL(:OLD.RTO_ACT,' ') != NVL(:NEW.RTO_ACT,' ') OR NVL(:OLD.RTO_EST,' ') != NVL(:NEW.RTO_EST,' ')) ) THEN
		isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
	END IF;
    END IF;
    -- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - MILESTONE_CHANGE
    IF(:NEW.ONEF_SITE_NFID IS NULL AND :NEW.TRANSPORT_VENDOR = 'OneFiber' AND ( NVL(:OLD.POR_SITE,' ') != NVL(:NEW.POR_SITE,' ') OR NVL(:OLD.ONEF_FIBER_STRANDS_NEEDED,' ') != NVL(:NEW.ONEF_FIBER_STRANDS_NEEDED,' ') OR
	NVL(:OLD.HUB_DETAILS,' ') != NVL(:NEW.HUB_DETAILS,' ') OR NVL(:OLD.BUILD_PLAN_YEAR_STATUS,' ') != NVL(:NEW.BUILD_PLAN_YEAR_STATUS,' ') OR NVL(:OLD.ROOT_RANK,' ') != NVL(:NEW.ROOT_RANK,' ') OR
	NVL(:OLD.RTO_ACT,' ') != NVL(:NEW.RTO_ACT,' ') OR NVL(:OLD.RTO_EST,' ') != NVL(:NEW.RTO_EST,' ')) ) THEN
	    INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
	    VALUES(null,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
    END IF;
-- api queue entry - MILESTONE_CHANGE - INFRANCHISE precandidate
    IF (NVL(UPPER(:NEW.ONEF_NOTIFIED),' ') = 'YES' AND :NEW.TRANSPORT_VENDOR = 'VZT FUZE') THEN
	IF(:NEW.ONEF_SITE_NFID IS NOT NULL AND ( NVL(:OLD.POR_SITE,' ') != NVL(:NEW.POR_SITE,' ') OR NVL(:OLD.ONEF_FIBER_STRANDS_NEEDED,' ') != NVL(:NEW.ONEF_FIBER_STRANDS_NEEDED,' ') OR
	    NVL(:OLD.HUB_DETAILS,' ') != NVL(:NEW.HUB_DETAILS,' ') OR NVL(:OLD.BUILD_PLAN_YEAR_STATUS,' ') != NVL(:NEW.BUILD_PLAN_YEAR_STATUS,' ') OR NVL(:OLD.ROOT_RANK,' ') != NVL(:NEW.ROOT_RANK,' ') OR
	    NVL(:OLD.RTO_ACT,' ') != NVL(:NEW.RTO_ACT,' ') OR NVL(:OLD.RTO_EST,' ') != NVL(:NEW.RTO_EST,' ')) ) THEN
		isSuccess := FUNC_INSERT_API_QUEUE('INFRANCHISE','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
	END IF;
    END IF;
    -- ONEF_COE_CUTOVER_EVENT_QUEUE queue entry - MILESTONE_CHANGE - INFRANCHISE precandidate
    IF(:NEW.ONEF_SITE_NFID IS NULL AND :NEW.TRANSPORT_VENDOR = 'VZT FUZE' AND ( NVL(:OLD.POR_SITE,' ') != NVL(:NEW.POR_SITE,' ') OR NVL(:OLD.ONEF_FIBER_STRANDS_NEEDED,' ') != NVL(:NEW.ONEF_FIBER_STRANDS_NEEDED,' ') OR
	NVL(:OLD.HUB_DETAILS,' ') != NVL(:NEW.HUB_DETAILS,' ') OR NVL(:OLD.BUILD_PLAN_YEAR_STATUS,' ') != NVL(:NEW.BUILD_PLAN_YEAR_STATUS,' ') OR NVL(:OLD.ROOT_RANK,' ') != NVL(:NEW.ROOT_RANK,' ') OR
	NVL(:OLD.RTO_ACT,' ') != NVL(:NEW.RTO_ACT,' ') OR NVL(:OLD.RTO_EST,' ') != NVL(:NEW.RTO_EST,' ')) ) THEN
	    INSERT INTO ONEF_COE_CUTOVER_EVENT_QUEUE(EVENT_ID,SITE_PROJECTS_ID,WORK_STEP_NAME,STATUS,CREATED_BY,CREATED_DATE)
	    VALUES(null,:NEW.SITE_PROJECTS_ID,'MILESTONE_CHANGE','QUEUED',:NEW.LAST_MODIFIED_BY,sysdate);
    END IF;
	-- api queue entry - MILESTONE_CHANGE - INFRANCHISE precandidate --END


-- when TRANSPORT_VENDOR changes to Hub-OneFiber
    IF( :NEW.ONEF_CLUSTER_NFID IS NULL AND NVL(:OLD.TRANSPORT_VENDOR,' ') != NVL(:NEW.TRANSPORT_VENDOR,' ') AND :NEW.TRANSPORT_VENDOR = 'Hub-OneFiber') THEN
	isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'ADD_HUB',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
	:NEW.FINAL_HUB_SITE_INFO_ID :=0;
	:NEW.TRANSPORT_NEED_BY_DATE :=NULL;
	:NEW.ONEF_NOTIFIED :='YES';
    END IF;
    -- when TRANSPORT_VENDOR changes from OneFiber to Hub-OneFiber
    IF( NVL(:OLD.TRANSPORT_VENDOR,' ') != NVL(:NEW.TRANSPORT_VENDOR,' ') AND :NEW.TRANSPORT_VENDOR = 'Hub-OneFiber' AND :OLD.TRANSPORT_VENDOR = 'OneFiber') THEN
	isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'ADD_HUB',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
	:NEW.FINAL_HUB_SITE_INFO_ID :=0;
	:NEW.TRANSPORT_NEED_BY_DATE :=NULL;
	:NEW.ONEF_NOTIFIED :='YES';
    END IF;
   -- api queue entry when TRANSPORT_VENDOR changed from Hub-OneFiber - HUB_TRANSPORT_VENDOR_MOVE  - CANCEL flow
    IF(:OLD.ONEF_CLUSTER_NFID IS NOT NULL AND NVL(:OLD.TRANSPORT_VENDOR,' ') = 'Hub-OneFiber'  AND NVL(:OLD.TRANSPORT_VENDOR,' ') != NVL(:NEW.TRANSPORT_VENDOR,' ')) THEN
	    isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'HUB_TRANSPORT_VENDOR_MOVE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
:NEW.VZB_PATH_B_TRANSPORT_READY_ACT :=NULL;
:NEW.VZB_PATH_A_TRANSPORT_READY_ACT :=NULL;
:NEW.VZB_OVERALL_PATH_READY_EST :=NULL;
:NEW.VZB_PATH_A_TRANSPORT_READY_EST :=NULL;
:NEW.VZB_PATH_B_TRANSPORT_READY_EST :=NULL;
:NEW.VZB_OVERALL_PATH_READY_ACT :=NULL;
:NEW.FIBER_PATH_A_READY_ACT :=NULL;
:NEW.FIBER_PATH_A_READY_EST :=NULL;
:NEW.FIBER_PATH_B_READY_EST :=NULL;
:NEW.FIBER_PATH_B_READY_ACT :=NULL;
    END IF;
    -- api queue entry when TRANSPORT_VENDOR back to Hub-OneFiber -UNCANCEL_HUB_TRANSPORT_VENDOR_MOVE - UNCANCEL flow
    IF( :OLD.ONEF_CLUSTER_NFID IS NOT NULL AND NVL(:OLD.TRANSPORT_VENDOR,' ') != NVL(:NEW.TRANSPORT_VENDOR,' ') AND :OLD.CRAN_PEER_SITE_STATUS IN ('Cancelled') AND :NEW.TRANSPORT_VENDOR = 'Hub-OneFiber') THEN
	    :NEW.ONEF_NOTIFIED :='YES';
	isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'UNCANCEL_HUB_TRANSPORT_VENDOR_MOVE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
    END IF;
-- api queue entry for HUB_MILESTONE_CHANGE
--IF (NVL(UPPER(:NEW.ONEF_NOTIFIED),' ') = 'YES') THEN
	IF(:OLD.ONEF_CLUSTER_NFID IS NOT NULL AND :OLD.TRANSPORT_VENDOR = 'Hub-OneFiber' AND :NEW.TRANSPORT_VENDOR = 'Hub-OneFiber' AND ( NVL(:OLD.BACKHAUL_NEED_BY_DATE,' ') != NVL(:NEW.BACKHAUL_NEED_BY_DATE,' ') OR NVL(:OLD.ONEF_TRANSPORT_ROOM_READY_F,' ') != NVL(:NEW.ONEF_TRANSPORT_ROOM_READY_F,' ') OR
	    NVL(:OLD.ONEF_TRANSPORT_ROOM_READY_A,' ') != NVL(:NEW.ONEF_TRANSPORT_ROOM_READY_A,' ') OR NVL(:OLD.ONEF_PSCR_READY_A,' ') != NVL(:NEW.ONEF_PSCR_READY_A,' ') OR NVL(:OLD.ONEF_PSCR_READY_F,' ') != NVL(:NEW.ONEF_PSCR_READY_F,' ') OR
	    NVL(:OLD.HUB_SINGLE_ENTRY_EST,' ') != NVL(:NEW.HUB_SINGLE_ENTRY_EST,' ') OR NVL(:OLD.HUB_SINGLE_ENTRY_ACT,' ') != NVL(:NEW.HUB_SINGLE_ENTRY_ACT,' ') OR NVL(:OLD.ONEF_HUB_DUAL_ENTRY_A,' ') != NVL(:NEW.ONEF_HUB_DUAL_ENTRY_A,' ') OR NVL(:OLD.ONEF_HUB_DUAL_ENTRY_F,' ') != NVL(:NEW.ONEF_HUB_DUAL_ENTRY_F,' ') OR NVL(:OLD.ONEF_CLLI,' ') != NVL(:NEW.ONEF_CLLI,' ') OR NVL(:OLD.CURRENT_BACKHAUL_TRANSPORT_VENDOR,' ') != NVL(:NEW.CURRENT_BACKHAUL_TRANSPORT_VENDOR,' ') OR NVL(:OLD.CURRENT_BACKHAUL_VENDOR_TERM,' ') != NVL(:NEW.CURRENT_BACKHAUL_VENDOR_TERM,' ') OR NVL(:OLD.ONEF_HUB_TYPE,' ') != NVL(:NEW.ONEF_HUB_TYPE,' ') OR NVL(:OLD.ONEF_SPACE_POWER_ASSESSMENT_INCLUDE_VZB_NEEDS,' ') != NVL(:NEW.ONEF_SPACE_POWER_ASSESSMENT_INCLUDE_VZB_NEEDS,' ')) ) THEN
		isSuccess := FUNC_INSERT_API_QUEUE('ONE_FIBER','SITE_MANAGEMENT',NULL,:NEW.SITE_PROJECTS_ID,'HUB_MILESTONE_CHANGE',NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
	END IF;
    --END IF;
    -- api queue entry code ends
    --pushing uace and tv to site starts
   /* -- Disabled by Nipun, please do not enable
   IF(NVL(:OLD.UACE_ID,0) != NVL(:NEW.UACE_ID,0)) THEN
	PROC_ONEF_UPDATE_SITE_FROM_PROJECT (:NEW.SITE_PROJECTS_ID,:NEW.UACE_ID,:NEW.TRANSPORT_VENDOR,'true',:NEW.LAST_MODIFIED_BY);
    END IF;*/
    --pushing uace and tv to site ends
-- Not allow CIRCUIT_DELIVERY(TRANSPORT COMPLETE) fields to be edited when TRANSPORT_VENDOR='OneFiber' and WEST projs
    --	  IF((:NEW.TRANSPORT_VENDOR = 'OneFiber' AND isProjWest > 0)  and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC') ) THEN
    --	      :NEW.CIRCUIT_DELIVERY_EST := :OLD.CIRCUIT_DELIVERY_EST;
    --	      :NEW.CIRCUIT_DELIVERY_ACT := :OLD.CIRCUIT_DELIVERY_ACT;
    --	  END IF;
 -- non editable fields start --
 --  IF( (:NEW.TRANSPORT_VENDOR NOT IN ('OneFiber','Hub-OneFiber','VZT FUZE') and :OLD.TRANSPORT_VENDOR != 'OneFiber') and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC')) THEN
	IF(TRIM(:NEW.TRANSPORT_VENDOR) IS NULL and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC')) THEN
    :NEW.ONEF_FIBER_STRANDS_NEEDED := :OLD.ONEF_FIBER_STRANDS_NEEDED;
    END IF;
    IF( (:NEW.TRANSPORT_VENDOR = 'OneFiber' and :OLD.TRANSPORT_VENDOR != 'OneFiber') and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC')) THEN
	:NEW.SPLICE_AND_TEST_EST := :OLD.SPLICE_AND_TEST_EST;
	:NEW.SPLICE_AND_TEST_ACT := :OLD.SPLICE_AND_TEST_ACT;
	:NEW.CABLE_PLACED_EST := :OLD.CABLE_PLACED_EST;
	:NEW.CABLE_PLACED_ACT := :OLD.CABLE_PLACED_ACT;
	:NEW.PERMITS_RECEIVED_EST := :OLD.PERMITS_RECEIVED_EST;
	:NEW.PERMITS_RECEIVED_ACT := :OLD.PERMITS_RECEIVED_ACT;
	:NEW.TRANS_CONTR_FOC_FC_DT := :OLD.TRANS_CONTR_FOC_FC_DT;
	:NEW.TRANS_CONTR_FOC_AC_DT := :OLD.TRANS_CONTR_FOC_AC_DT;
    END IF;
    -- IF( (:NEW.TRANSPORT_VENDOR != 'OneFiber' and :OLD.TRANSPORT_VENDOR != 'OneFiber') and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC')) THEN
	-- :NEW.POR_SITE := :OLD.POR_SITE;
    -- END IF;
 -- non editable fields start
 -- IF( (:NEW.TRANSPORT_VENDOR != 'Hub-OneFiber' OR :NEW.TRANSPORT_VENDOR IS NULL) and :NEW.LAST_MODIFIED_BY not in('Fuze-OneFiber','NARSYNC')) THEN
    --	  :NEW.ONEF_HUB_SIZE := null;
    -- :NEW.ONEF_CLLI := null;
    -- :NEW.MSC := null;
    -- :NEW.ONEF_HUB_TYPE  := null;
    -- :NEW.ONEF_ENTITLEMENTS_COMPLETE := null;
    -- :NEW.ONEF_BUILDING_OWNER  := null;
    -- :NEW.ONEF_LOCATION_LEASE_OR_OWNED := null;
    -- :NEW.ONEF_ASSESSMENT_VZB_DATE := null;
    -- :NEW.ONEF_REVIEW_DATE := null;
    -- :NEW.ONEF_ENTITLEMENT_DATE := null;
    -- :NEW.BACKHAUL_NEED_BY_DATE := null;
    -- :NEW.ONEF_LOCATION_TYPE := null;
    -- :NEW.ONEF_SPACE_POWER_ASSESSMENT_INCLUDE_VZB_NEEDS := null;
    -- :NEW.ONEF_ASSESSMENT_DATE := null;
--   END IF;
-- non editable fields end

-- FINAL_HUB_SITE_INFO_ID Updates start
    IF (NVL(:OLD.FINAL_HUB_SITE_INFO_ID,0) != NVL(:NEW.FINAL_HUB_SITE_INFO_ID,0)) THEN
    -- Updating the FINAL_HUB_SITE_INFO_ID at sites
IF(NVL(:NEW.FINAL_HUB_SITE_INFO_ID,0) !=0 AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'HUB_READY_INSERT') != 'COMPLETED') THEN
		--PROC_INSERT_PROJ_TASKS(:NEW.SITE_PROJECTS_ID,0,0,'HUB_READY_INSERT','COMPLETE','ACTIVE','',:NEW.LAST_MODIFIED_BY,NULL,'PROJ_TRANSPORT_ATTRIBUTES');
		INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''HUB_READY_INSERT'',''COMPLETE'',''ACTIVE'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
		CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
	ELSE
		IF(v_projType !='Modification' OR v_hubReadyprojModType ='true') THEN
		--PROC_INSERT_PROJ_TASKS(:NEW.SITE_PROJECTS_ID,0,0,'HUB_READY_INSERT','COMPLETE','N/A','',:NEW.LAST_MODIFIED_BY,NULL,'PROJ_TRANSPORT_ATTRIBUTES');
		INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''HUB_READY_INSERT'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
		CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
		END IF;
	END IF;

	-- Adding for tracker Sync
	--PROC_SYNC_PROJECT_TRACKER_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID);
	INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_SYNC_PROJECT_TRACKER_WORKSTEP_STATUS('||:NEW.SITE_PROJECTS_ID||')',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);

	--Updating the FINAL_HUB_SITE_INFO_ID at sites
	--PROC_SYNC_FINAL_HUB_PROJ_TO_SITE(:NEW.SITE_PROJECTS_ID,:NEW.FINAL_HUB_SITE_INFO_ID,:NEW.TRANSPORT_VENDOR,:NEW.LAST_MODIFIED_BY);
	 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	 VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_SYNC_FINAL_HUB_PROJ_TO_SITE('||:NEW.SITE_PROJECTS_ID||','||:NEW.FINAL_HUB_SITE_INFO_ID||','''||:NEW.TRANSPORT_VENDOR||''','''||:NEW.LAST_MODIFIED_BY||''')',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    -- Updating the FINAL_HUB_SITE_INFO_ID in GRANITE
	PROC_INSERT_API_QUEUE('GRANITE','UPDATE_SITE',NULL,:NEW.SITE_PROJECTS_ID,NULL,NULL,NULL,'QUEUED',:new.LAST_MODIFIED_BY);

END IF;
-- FINAL_HUB_SITE_INFO_ID Updates end

    -- Updating the Hub Size at sites
    IF (NVL(:OLD.ONEF_HUB_SIZE,' ') != NVL(:NEW.ONEF_HUB_SIZE,' ')) THEN
	INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	declare
	v_rowcount NUMBER DEFAULT 0;
	Begin
	FOR ax in (SELECT SI.SITE_INFO_ID,CI.HUB_SITE_INFO_ID FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
	INNER JOIN CRAN_INFO CI ON CI.HUB_SITE_INFO_ID=SI.SITE_INFO_ID AND CI.CRAN_STATUS!=''DELETED'' WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	LOOP
	   UPDATE CRAN_INFO SET
	   APPROVED_HUB_DESIGNATION='''|| :NEW.ONEF_HUB_SIZE||''',
	   CRAN_LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
	   CRAN_LAST_MODIFIED_DATE = SYSDATE
	   where HUB_SITE_INFO_ID = ax.SITE_INFO_ID;
	   v_rowcount := SQL%rowcount;
	 end loop;
	 end;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    -- create hub in cran when Hub-OneFiber vendor is selected
    IF(NVL(:OLD.TRANSPORT_VENDOR,' ') != NVL(:NEW.TRANSPORT_VENDOR,' ') AND :NEW.TRANSPORT_VENDOR = 'Hub-OneFiber') THEN
	BEGIN
	    SELECT SI.SITE_INFO_ID into hubSiteInfoId FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in ('Primary','Live')
	    WHERE SITE_PROJECTS_ID=:NEW.SITE_PROJECTS_ID;
	EXCEPTION WHEN NO_DATA_FOUND THEN
	    hubSiteInfoId := 0;
	END;
	INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	declare
	v_rowcount NUMBER DEFAULT 0;
	Begin
	FOR ax in ( SELECT SI.* FROM SITE_PROJECTS_MAP SPM
		    INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID
		    AND SI.STATUS in (''Primary'',''Live'') WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	LOOP
	   UPDATE CRAN_INFO SET
	   CRAN_STATUS= '' '',
	   CRAN_LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
	   CRAN_LAST_MODIFIED_DATE = SYSDATE
	   where HUB_SITE_INFO_ID = ax.SITE_INFO_ID;
	   v_rowcount := SQL%rowcount;
	   if (v_rowcount =0) then
		INSERT INTO CRAN_INFO(HUB_SITE_INFO_ID,CRAN_NAME,CRAN_STATUS,FINAL_HUB_SITE_NAME,FINAL_HUB_SITE_ID,CRAN_LAST_MODIFIED_BY,CRAN_LAST_MODIFIED_DATE)
		VALUES(ax.SITE_INFO_ID,ax.SITE_NAME,'' '',ax.SITE_NAME,ax.SITE_INFO_ID,'''||:NEW.LAST_MODIFIED_BY||''',SYSDATE);
	    end if;
	END LOOP;
	end;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    -- create hub in cran when Hub-OneFiber vendor is selected
    -- Api queue insert to create new quote
    IF( ( :NEW.IS_BULK_QUOTE_CREATE='YES' AND :NEW.TRANSPORT_VENDOR = 'VZT FUZE' AND NVL(:NEW.FINAL_HUB_SITE_INFO_ID,0)!=0 AND NVL(:NEW.TRANSPORT_NEED_BY_DATE,' ')!=' ' AND NVL(:NEW.ONEF_FIBER_STRANDS_NEEDED,' ')!=' '
	AND NVL(:NEW.PRODUCT_TYPE,' ')!=' ' AND NVL(:NEW.PRODUCT_SUB_TYPE,' ')!=' ' AND NVL(:NEW.SERVICE_DESCRIPTOR,' ')!=' ' AND NVL(:NEW.DISTANCE_LIMITATION,0)!=0
	AND NVL(:NEW.CONNECTOR_TYPE,' ')!=' ' AND NVL(:NEW.STRUCTURE_TYPE,' ')!=' ' ) AND
	( NVL(:OLD.FINAL_HUB_SITE_INFO_ID,0) != NVL(:NEW.FINAL_HUB_SITE_INFO_ID,0) OR NVL(:OLD.TRANSPORT_NEED_BY_DATE,' ') != NVL(:NEW.TRANSPORT_NEED_BY_DATE,' ') OR
	  NVL(:OLD.ONEF_FIBER_STRANDS_NEEDED,' ') != NVL(:NEW.ONEF_FIBER_STRANDS_NEEDED,' ') OR NVL(:OLD.PRODUCT_TYPE,' ') != NVL(:NEW.PRODUCT_TYPE,' ') OR
	  NVL(:OLD.PRODUCT_SUB_TYPE,' ') != NVL(:NEW.PRODUCT_SUB_TYPE,' ') OR NVL(:OLD.SERVICE_DESCRIPTOR,' ') != NVL(:NEW.SERVICE_DESCRIPTOR,' ') OR
	  NVL(:OLD.DISTANCE_LIMITATION,0) != NVL(:NEW.DISTANCE_LIMITATION,0) OR NVL(:OLD.CONNECTOR_TYPE,' ') != NVL(:NEW.CONNECTOR_TYPE,' ') OR
	  NVL(:OLD.STRUCTURE_TYPE,' ') != NVL(:NEW.STRUCTURE_TYPE,' ') )
      ) THEN
	    isSuccess := FUNC_INSERT_API_QUEUE('INFRANCHISE','CREATE_QUOTE',NULL,:NEW.SITE_PROJECTS_ID,NULL,NULL,0,NULL,:NEW.LAST_MODIFIED_BY);
	    :NEW.IS_BULK_QUOTE_CREATE :=NULL;
    END IF;
    IF(NVL(:OLD.ONEF_PSCR_READY_F,SYSDATE) != NVL(:NEW.ONEF_PSCR_READY_F,SYSDATE)) THEN
	 INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	 VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	 declare
	 v_rowcount NUMBER DEFAULT 0;
	 Begin
	 FOR ax in (SELECT SI.SITE_INFO_ID FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
	 WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	 LOOP
	   UPDATE CRAN_TRACKER_INFO SET
	   ONEF_PSCR_READY_F='''||:NEW.ONEF_PSCR_READY_F||''',
	   LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
	   LAST_MODIFIED_DATE = SYSDATE
	   where SITE_INFO_ID = ax.SITE_INFO_ID;
	   v_rowcount := SQL%rowcount;
	 end loop;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    IF(NVL(:OLD.ONEF_PSCR_READY_A,SYSDATE) != NVL(:NEW.ONEF_PSCR_READY_A,SYSDATE)) THEN
	    INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	    VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	    declare
	    v_rowcount NUMBER DEFAULT 0;
	    Begin
	    FOR ax in (SELECT SI.SITE_INFO_ID FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
	    WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	    LOOP
	       UPDATE CRAN_TRACKER_INFO SET
	       ONEF_PSCR_READY_A='''||:NEW.ONEF_PSCR_READY_A||''',
	       LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
	       LAST_MODIFIED_DATE = SYSDATE
	       where SITE_INFO_ID = ax.SITE_INFO_ID;
	       v_rowcount := SQL%rowcount;
	    end loop;
	    end;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    IF(NVL(:OLD.ONEF_HUB_DUAL_ENTRY_F,SYSDATE) != NVL(:NEW.ONEF_HUB_DUAL_ENTRY_F,SYSDATE)) THEN
	    INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	    VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	    declare
	    v_rowcount NUMBER DEFAULT 0;
	    Begin
	    FOR ax in (SELECT SI.SITE_INFO_ID FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
	    WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	    LOOP
		UPDATE CRAN_TRACKER_INFO SET
		HUB_DUAL_ENTRY_F='''||:NEW.ONEF_HUB_DUAL_ENTRY_F||''',
		LAST_MODIFIED_BY ='''|| :NEW.LAST_MODIFIED_BY||''',
		LAST_MODIFIED_DATE = SYSDATE
		where SITE_INFO_ID = ax.SITE_INFO_ID;
		v_rowcount := SQL%rowcount;
	    end loop;
	    end;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
    IF(NVL(:OLD.ONEF_HUB_DUAL_ENTRY_A,SYSDATE) != NVL(:NEW.ONEF_HUB_DUAL_ENTRY_A,SYSDATE)) THEN
	INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	declare
	v_rowcount NUMBER DEFAULT 0;
	Begin
	FOR ax in (SELECT SI.SITE_INFO_ID FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID= SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
	WHERE SITE_PROJECTS_ID='||:NEW.SITE_PROJECTS_ID||')
	LOOP
	   UPDATE CRAN_TRACKER_INFO SET
	   HUB_DUAL_ENTRY_A='''||:NEW.ONEF_HUB_DUAL_ENTRY_A||''',
	   LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
	   LAST_MODIFIED_DATE = SYSDATE
	   where SITE_INFO_ID = ax.SITE_INFO_ID;
	   v_rowcount := SQL%rowcount;
	 end loop;
	 end;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
    END IF;
	   --TRANSPORT_TYPE_APPLIED field condition
	   IF (NVL(TRIM(:NEW.TRANSPORT_TYPE),' ') != NVL(TRIM(:old.TRANSPORT_TYPE),' ')) THEN

			IF (NVL(TRIM(:NEW.TRANSPORT_TYPE),' ') != ' ') THEN
				:new.TRANSPORT_TYPE_APPLIED:=TO_CHAR(SYSDATE, 'mm/dd/yyyy');
			ELSE
				:new.TRANSPORT_TYPE_APPLIED:=NULL;
			END IF;
	   END IF;
	 --Make Transport milestone NA if transport vendor removed
	IF(TRIM(:NEW.TRANSPORT_VENDOR) IS NULL AND TRIM(:OLD.TRANSPORT_VENDOR) IS NOT NULL AND FUNC_GET_WORKSTEP_STATUS(:NEW.SITE_PROJECTS_ID,'TRANSPORT') ='COMPLETED' and v_projType = 'Modification' and v_projModType NOT IN('TRANSPORT_DISCONNECT','TRANSPORT_ETL_DISCONNECT')) THEN
		INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY) VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''ENABLE_TRANSPORT_NON_ONEF'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,NULL)',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
	END IF;
	--Make Hub-ready milestone NA if FINAL_HUB_SITE_INFO_ID removed
	IF (NVL(:OLD.FINAL_HUB_SITE_INFO_ID,0) != 0 AND NVL(:NEW.FINAL_HUB_SITE_INFO_ID,0) = 0 AND v_projType = 'Modification' AND v_projModType NOT IN('TRANSPORT_DISCONNECT','TRANSPORT_ETL_DISCONNECT')) THEN
		INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
		VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','PROCEDURE','PROC_INSERT_PROJ_TASKS('||:NEW.SITE_PROJECTS_ID||',0,0,''HUB_READY_INSERT'',''COMPLETE'',''N/A'','''','''||:NEW.LAST_MODIFIED_BY||''',NULL,''PROJ_TRANSPORT_ATTRIBUTES'')',
		CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);
	END IF;
	--Reverting retry count to 0 when status is changed from system Error F-5106
	IF((NVL(:OLD.CRAN_PEER_SITE_STATUS,' ') != NVL(:NEW.CRAN_PEER_SITE_STATUS,' ')) AND  :OLD.CRAN_PEER_SITE_STATUS = 'SystemError' AND :NEW.CRAN_PEER_SITE_STATUS IS NOT NULL) THEN
	:NEW.RETRY_COUNT := 0;
	END IF;

END IF;

--move nfid from hub project to diverse project

IF( (NVL(TRIM(:NEW.TRANSPORT_VENDOR),' ') != NVL(TRIM(:OLD.TRANSPORT_VENDOR),' ')) AND NVL(TRIM(:NEW.TRANSPORT_VENDOR),' ') = 'OneFiber Diverse') THEN

    INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
	VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
	declare
	hubSiteInfoId NUMBER;
    v_hub_onef_cluster_nfid varchar2(64);
	BEGIN

    BEGIN
	    SELECT SI.SITE_INFO_ID into hubSiteInfoId FROM SITE_PROJECTS_MAP SPM INNER JOIN SITE_INFO SI ON SI.SITE_INFO_ID = SPM.SITE_INFO_ID AND SI.STATUS in (''Primary'',''Live'')
	    WHERE SITE_PROJECTS_ID = ' || :NEW.SITE_PROJECTS_ID ||' FETCH FIRST ROW ONLY;
	EXCEPTION WHEN NO_DATA_FOUND THEN
	    hubSiteInfoId := 0;
	END;

    BEGIN
	 select ONEF_CLUSTER_NFID into v_hub_onef_cluster_nfid from proj_transport_attributes pta join site_projects_map spm on spm.site_projects_id = pta.site_projects_id
	 where spm.site_info_id = hubSiteInfoId and pta.transport_vendor IN (''Hub-OneFiber'',''VZT HUB'') FETCH FIRST ROW ONLY;
	 EXCEPTION WHEN NO_DATA_FOUND THEN NULL;
    END;

	UPDATE PROJ_TRANSPORT_ATTRIBUTES SET
	ONEF_CLUSTER_NFID = v_hub_onef_cluster_nfid,
	LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
	LAST_MODIFIED_DATE = SYSDATE
	WHERE SITE_PROJECTS_ID = ' || :NEW.SITE_PROJECTS_ID || ';

	END;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);

END IF;

IF(NVL(TRIM(:NEW.TRANSPORT_VENDOR),' ') != 'OneFiber' AND NVL(TRIM(:OLD.TRANSPORT_VENDOR),' ') ='OneFiber')then

INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','BEGIN UPDATE PROJ_TRANSPORT_ATTRIBUTES SET FIBER_DISTANCE = NULL,LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',LAST_MODIFIED_DATE = SYSDATE WHERE SITE_PROJECTS_ID = ' || :NEW.SITE_PROJECTS_ID || ';END;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);

END IF;

--- NTSWSF-3276 Changes start here -----
 IF ( v_onefibernppfuze > 0 ) THEN
	:new.transport_vendor := NULL;
	:new.final_hub_site_info_id := 0;
	:new.onef_fiber_strands_needed := NULL;
 END IF;
--- NTSWSF-3276 Changes Ends here -----

IF(NVL(TRIM(:NEW.TRANSPORT_VENDOR),' ') = 'OneFiber' AND NVL(TRIM(:OLD.TRANSPORT_VENDOR),' ') !='OneFiber')then

INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','BEGIN
UPDATE PROJ_TRANSPORT_ATTRIBUTES SET
FIBER_DISTANCE = (SELECT MAX(TO_NUMBER(OLEDT.OPTICAL_LENGTH))  FROM ONEFT_LOCATION_END_DEMARC_TEST OLEDT
INNER JOIN ONEFT_ORDER ONO ON ONO.ONEFT_ORDER_ID = OLEDT.ONEFT_ORDER_ID
WHERE ONO.ORDER_STATUS IN (''COMPLETED'',''LIVE'') AND ONO.SITE_PROJECTS_ID = ' || :NEW.SITE_PROJECTS_ID ||'   AND OLEDT.OPTICAL_LENGTH IS NOT NULL),
LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||''',
LAST_MODIFIED_DATE=SYSDATE
WHERE SITE_PROJECTS_ID=' || :NEW.SITE_PROJECTS_ID ||' ;
END;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);

END IF;

IF(NVL(TRIM(:NEW.FIBER_DISTANCE),' ') != NVL(TRIM(:OLD.FIBER_DISTANCE),' '))then

INSERT INTO PROJ_PTA_FIELDS_TRIGGER_LOGIC_QUEUE(SITE_PROJECTS_ID,STATUS,OBJECT_TYPE,OBJECT_TO_EXECUTE,QUEUED_DATE,LAST_MODIFIED_BY)
VALUES(:NEW.SITE_PROJECTS_ID,'QUEUED','TABLE_UPDATE','
DECLARE v_site_info_id NUMBER;
BEGIN
BEGIN
SELECT SPM.SITE_INFO_ID into v_site_info_id  FROM SITE_PROJECTS_MAP SPM
INNER JOIN SITE_INFO SI on SPM.site_info_id=SI.site_info_id
WHERE SI.SARF_SITE=''YES'' AND	SPM.SITE_PROJECTS_ID= ' || :NEW.SITE_PROJECTS_ID ||';
EXCEPTION WHEN NO_DATA_FOUND THEN
	    v_site_info_id := 0;
END;
update SITE_TRANSPORT_ATTRIBUTES SET
SITE_FIBER_DISTANCE='''||:NEW.FIBER_DISTANCE||''',
LAST_MODIFIED_DATE=SYSDATE,
LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||'''
WHERE SITE_INFO_ID=v_site_info_id;

update SITES_TRACKER_DATA SET
SITE_FIBER_DISTANCE='''||:NEW.FIBER_DISTANCE||''',
LAST_MODIFIED_DATE=SYSDATE,
LAST_MODIFIED_BY = '''||:NEW.LAST_MODIFIED_BY||'''
WHERE SITE_INFO_ID=v_site_info_id;


END;',CURRENT_TIMESTAMP,:NEW.LAST_MODIFIED_BY);

END IF;

  --Preventing CRAN_PEER_SITE_STATUS update when review date is present
    IF((NVL(:OLD.CRAN_PEER_SITE_STATUS,' ') != NVL(:NEW.CRAN_PEER_SITE_STATUS,' ') OR NVL(:OLD.ONEF_STATUS_DESCRIPTION,' ') != NVL(:NEW.ONEF_STATUS_DESCRIPTION,' ')) AND  :NEW.TRANSPORT_VENDOR = 'OneFiber' AND :NEW.ONEF_PROJ_REVIEW_DATE IS NOT NULL) THEN

		:NEW.CRAN_PEER_SITE_STATUS :='ProjectUnderReview';
   		:NEW.ONEF_STATUS_DESCRIPTION := 'Project is under review by the 1F and RAN Leadership Teams and may be rejected';
    END IF;
	---Review Changes End

	--For TransportVendor Eline change
	IF(:OLD.TRANSPORT_VENDOR IS NOT NULL AND :NEW.TRANSPORT_VENDOR IS NOT NULL AND TRIM(:OLD.TRANSPORT_VENDOR) = 'E-LINE' AND TRIM(:NEW.TRANSPORT_VENDOR) !='E-LINE') THEN

		PROC_INSERT_API_QUEUE('SPM','ELINE_VENDORCHANGE',NULL,:OLD.SITE_PROJECTS_ID,NULL,NULL,NULL,'QUEUED',:NEW.LAST_MODIFIED_BY);

	END IF;

	IF(:OLD.TRANSPORT_VENDOR IS NOT NULL AND :NEW.TRANSPORT_VENDOR IS NOT NULL AND TRIM(:OLD.TRANSPORT_VENDOR) = 'VZT FUZE' AND TRIM(:NEW.TRANSPORT_VENDOR) !='VZT FUZE') THEN

		PROC_INSERT_API_QUEUE('INFRANCHISE','TV_REMOVAL_SPOKE',NULL,:OLD.SITE_PROJECTS_ID,'TV_REMOVAL_SPOKE',NULL,NULL,'QUEUED',:NEW.LAST_MODIFIED_BY);

	END IF;

	IF(:OLD.TRANSPORT_VENDOR IS NOT NULL AND :NEW.TRANSPORT_VENDOR IS NOT NULL AND TRIM(:OLD.TRANSPORT_VENDOR) = 'VZT HUB' AND TRIM(:NEW.TRANSPORT_VENDOR) !='VZT HUB') THEN

		PROC_INSERT_API_QUEUE('INFRANCHISE','TV_REMOVAL_HUB',NULL,:OLD.SITE_PROJECTS_ID,'TV_REMOVAL_HUB',NULL,NULL,'QUEUED',:NEW.LAST_MODIFIED_BY);

	END IF;



END;
/
ALTER TRIGGER "FUZE_COPY"."ONEF_TRG_PROJ_TRANSPORT_ATTRIBUTES_BEFORE_INSERT_OR_UPDATE" ENABLE;











--------------------------------------------------------
see the TRANS_CONTR_FOC_AC_DT is getting null i dont know why,

i share PLsql trigger line, could you check and explian why getting null after changing TRANS_CONTR_FOC_AC_DT value
